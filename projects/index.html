<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projects — Robin Spahn</title>
  <meta name="description" content="Live projects pulled from GitHub with search, filters, badges, featured highlights, and collabs." />
  <meta name="theme-color" content="#0b0b10" />
  <link rel="preconnect" href="https://api.github.com" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="/assets/images/logo.svg" type="image/svg+xml" />
  <link rel="canonical" href="https://robinspahn.com/projects/" />
  <style>
    :root{
      --bg:#0b0b10; --panel:#12121a; --ink:#eef0f6; --muted:#a9adc1; --accent:#8a7dff; --accent-2:#12d6df; --chip:#171726;
      --radius:20px; --shadow:0 12px 40px rgba(0,0,0,.35);
      --step--1: clamp(12px, 0.78rem + 0.1vw, 14px);
      --step-0:  clamp(14px, 0.90rem + 0.2vw, 16px);
      --step-1:  clamp(18px, 1.05rem + 0.6vw, 22px);
      --step-2:  clamp(22px, 1.20rem + 1.0vw, 28px);
      --step-3:  clamp(28px, 1.60rem + 1.4vw, 36px);
    }
    html,body{margin:0;padding:0}
    body{background:
      radial-gradient(1200px 1200px at 120% -10%,rgba(18,214,223,.18),transparent 60%),
      radial-gradient(900px 900px at -20% 120%,rgba(138,125,255,.18),transparent 60%),
      var(--bg); color:var(--ink); font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; font-size:var(--step-0)}
    a{color:inherit;text-decoration:none}
    img, video, iframe{max-width:100%;height:auto}
    .wrap{max-width:1100px;margin:0 auto;padding:28px}

    .site-banner{width:100%;height:auto;display:block;border-bottom:1px solid rgba(255,255,255,.08);box-shadow:0 4px 20px rgba(0,0,0,.35);border-radius:0 0 var(--radius) var(--radius);margin-bottom:18px;object-fit:cover;max-height:320px}
    header.hero{display:grid;grid-template-columns:1fr;gap:10px;margin:6px 0 14px}
    .kicker{font-size:12px;letter-spacing:.22em;color:var(--muted);text-transform:uppercase}
    h1{font-size:var(--step-3);margin:0 0 6px;line-height:1.15}
    .sub{color:var(--muted);margin:0}
    .panel{background:linear-gradient(180deg,rgba(255,255,255,.02),transparent),var(--panel);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:var(--shadow);transition:transform .15s ease, border-color .2s ease}
    .panel.card{padding:16px}
    .panel.card:hover{transform:translateY(-2px);border-color:rgba(255,255,255,.12)}
    .nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
    .nav .links{display:flex;gap:14px;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.12);min-height:44px}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#0b0b10;border:none}
    .controls{display:flex;flex-wrap:wrap;gap:10px;padding:14px}
    .controls .field{display:flex;gap:8px;align-items:center;background:var(--chip);border:1px solid rgba(255,255,255,.06);padding:8px 10px;border-radius:12px}
    .controls input[type="search"]{all:unset;width:260px}
    select,button{background:var(--chip);border:1px solid rgba(255,255,255,.08);color:var(--ink);padding:10px 12px;border-radius:12px}
    button{cursor:pointer}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
    .title-row{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
    .title-row h4{margin:0;font-size:16px}
    .badges{display:flex;gap:6px;flex-wrap:wrap}
    .badge{font-size:12px;padding:5px 8px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1)}
    .desc{color:var(--muted);min-height:38px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:12px}
    .topics{display:flex;gap:6px;flex-wrap:wrap}
    .empty{padding:22px;text-align:center;color:var(--muted)}
    footer{opacity:.75;margin:22px 4px}
    @media (max-width:980px){ .wrap{padding:20px} .grid{grid-template-columns:repeat(2,minmax(0,1fr));gap:12px} }
    @media (max-width:680px){ .wrap{padding:14px} .site-banner{max-height:200px;border-radius:0 0 14px 14px;margin-bottom:12px} .controls{padding:10px;gap:8px;align-items:stretch} .controls .field{width:100%} .controls input[type=\"search\"]{width:100%} #reset{width:100%} .btn{padding:10px 12px;border-radius:10px} .grid{grid-template-columns:1fr;gap:12px} .panel.card{padding:14px} .badge{padding:4px 7px} }
    @media (prefers-reduced-motion: reduce){ *{animation:none!important;transition:none!important} }
  </style>
</head>
<body>
  <div class="wrap">
    <img class="site-banner" src="/assets/images/website_banner.png" alt="Banner for Robin Spahn">

    <nav class="nav" aria-label="Primary">
      <div class="links">
        <a href="/">Home</a>
        <a aria-current="page" class="badge" href="/projects/">Projects</a>
        <a href="/about/">About</a>
        <a class="btn" href="https://github.com/rspahn-dev" target="_blank" rel="noreferrer">GitHub</a>
      </div>
    </nav>

    <header class="hero">
      <div>
        <div class="kicker">Projects</div>
        <h1>Current work & collaborations</h1>
        <p class="sub">Search, filter, and click through for live demos and source.</p>
      </div>
    </header>

    <!-- Global Controls -->
    <section class="panel">
      <div class="controls">
        <div class="field">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
          <input id="q" type="search" placeholder="Search name, description, topics, or @owner…" />
        </div>
        <div class="field">
          <label for="lang">Lang</label>
          <select id="lang"><option value="">Any</option></select>
        </div>
        <div class="field">
          <label for="sort">Sort</label>
          <select id="sort">
            <option value="updated">Recently updated</option>
            <option value="stars">Most ★</option>
            <option value="alpha">A → Z</option>
          </select>
        </div>
        <button id="reset">Reset</button>
        <div style="margin-left:auto" class="muted"><span id="count">0</span> repos</div>
      </div>
    </section>

    <!-- Sections -->
    <section class="panel" id="current-section" style="padding:16px">
      <div class="kicker" style="margin-bottom:6px">Current Project</div>
      <div class="grid" id="current-grid"></div>
    </section>

    <section class="panel" style="margin-top:14px">
      <div class="kicker" style="padding:16px 16px 0">Collaborations</div>
      <div class="grid" id="collab-grid"></div>
      <div class="empty" id="collab-empty" hidden>No collaborations found.</div>
    </section>

    <section class="panel" style="margin-top:14px">
      <div class="kicker" style="padding:16px 16px 0">Personal Projects</div>
      <div class="grid" id="personal-grid"></div>
      <div class="empty" id="personal-empty" hidden>No personal projects found.</div>
    </section>

    <footer>Data from GitHub API · <a href="https://github.com/rspahn-dev" target="_blank" rel="noreferrer">@rspahn-dev</a></footer>
  </div>

<script>
// ===== CONFIG =====
// Owners whose repos to include automatically:
const GH_OWNERS = ["rspahn-dev"]; // add more owners/orgs here if you want all of their public repos

// Specific repos you DON'T own but want to include (full_name = "owner/repo"):
const COLLAB_REPOS = [
  "ajustfocus/qcm_flutter_app",
  // "grifkuba/some-shared-project"
];

// Choose a specific repo to pin as the Current Project (full_name), or leave "" to auto-pick most recently updated personal repo:
const CURRENT_PROJECT = ""; // e.g., "rspahn-dev/price-lens"

const GH_HEADERS = { 'Accept': 'application/vnd.github+json', 'X-GitHub-Api-Version': '2022-11-28' };

const pagesUrl = (owner, repo) => `https://${owner}.github.io/${repo}/`;

async function fetchReposFor(owner){
  const url = `https://api.github.com/users/${owner}/repos?per_page=100&sort=updated`;
  const res = await fetch(url, { headers: GH_HEADERS });
  if(!res.ok) throw new Error(`GitHub API ${res.status} for ${owner}`);
  const data = await res.json();
  return data.filter(r=>!r.fork).map(mapRepo);
}

async function fetchRepoByFullName(full){
  const url = `https://api.github.com/repos/${full}`;
  const res = await fetch(url, { headers: GH_HEADERS });
  if(!res.ok) throw new Error(`GitHub API ${res.status} for ${full}`);
  const r = await res.json();
  // Keep forks for explicit COLLAB_REPOS (you asked for it explicitly)
  return mapRepo(r); 
}


function mapRepo(r){
  return {
    id: r.id,
    name: r.name,
    full_name: r.full_name,
    owner: r.owner?.login,
    html_url: r.html_url,
    description: r.description,
    language: r.language,
    stargazers_count: r.stargazers_count,
    updated_at: r.updated_at,
    homepage: r.homepage && r.homepage.trim() ? r.homepage : null,
    topics: r.topics || [],
    archived: r.archived
  };
}

async function fetchAll(){
  const ownerLists = await Promise.allSettled(GH_OWNERS.map(fetchReposFor));
  const ownerRepos = ownerLists.flatMap(x => x.status === 'fulfilled' ? x.value : []);
  const collabLists = await Promise.allSettled(COLLAB_REPOS.map(fetchRepoByFullName));
  const collabRepos = collabLists.flatMap(x => (x.status === 'fulfilled' && x.value) ? [x.value] : []);
  // de-dup
  const byId = new Map([...ownerRepos, ...collabRepos].map(r=>[r.id,r]));
  return Array.from(byId.values());
}

function fmtDate(iso){ return new Date(iso).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'}); }

function demoButton(r){
  const url = r.homepage || pagesUrl(r.owner, r.name);
  return `<a class="btn primary" href="${url}" target="_blank" rel="noreferrer">Live demo</a>`;
}

function cardHTML(r){
  return `
    <article class="panel card">
      <div class="title-row">
        <h4>${r.name}</h4>
        <div class="badges">
          ${r.language ? `<span class="badge">${r.language}</span>` : ''}
          <span class="badge">★ ${r.stargazers_count}</span>
          <span class="badge">@${r.owner}</span>
        </div>
      </div>
      <p class="desc">${r.description ?? ''}</p>
      <div class="topics">
        ${(r.topics || []).slice(0,6).map(t=>`<span class="badge">#${t}</span>`).join('')}
      </div>
      <div class="meta">
        <span>Updated ${fmtDate(r.updated_at)}</span>
        ${r.archived ? '<span>· Archived</span>' : ''}
      </div>
      <div style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap">
        ${demoButton(r)}
        <a class="btn" href="${r.html_url}" target="_blank" rel="noreferrer">Source</a>
      </div>
    </article>
  `;
}

function renderLangOptions(repos){
  const sel = document.getElementById('lang');
  const langs = Array.from(new Set(repos.map(r => r.language).filter(Boolean))).sort();
  sel.innerHTML = '<option value="">Any</option>' + langs.map(l => `<option>${l}</option>`).join('');
}

function applyFilters(list){
  const q = document.getElementById('q').value.trim().toLowerCase();
  const lang = document.getElementById('lang').value;
  const sort = document.getElementById('sort').value;

  let filtered = list.slice();
  if (q){
    filtered = filtered.filter(r =>
      (r.name && r.name.toLowerCase().includes(q)) ||
      (r.description && r.description.toLowerCase().includes(q)) ||
      (r.owner && r.owner.toLowerCase().includes(q)) ||
      (r.topics && r.topics.join(' ').toLowerCase().includes(q))
    );
  }
  if (lang){ filtered = filtered.filter(r => r.language === lang); }

  if (sort === 'stars') filtered.sort((a,b)=>b.stargazers_count - a.stargazers_count);
  else if (sort === 'updated') filtered.sort((a,b)=> new Date(b.updated_at) - new Date(a.updated_at));
  else if (sort === 'alpha') filtered.sort((a,b)=> a.name.localeCompare(b.name));

  return filtered;
}

function renderSections(all){
  const currentGrid = document.getElementById('current-grid');
  const collabGrid  = document.getElementById('collab-grid');
  const personalGrid= document.getElementById('personal-grid');

  const filtered = applyFilters(all);
  document.getElementById('count').textContent = filtered.length;

  // Split into personal vs collab
  const personal = filtered.filter(r => r.owner && r.owner.toLowerCase() === "rspahn-dev");
  const collaborations = filtered.filter(r => r.owner && r.owner.toLowerCase() !== "rspahn-dev");

  // Current project (explicit pin or most recent personal)
  let current = null;
  if (CURRENT_PROJECT){
    current = filtered.find(r => r.full_name.toLowerCase() === CURRENT_PROJECT.toLowerCase());
  } 
  if (!current){
    current = personal.slice().sort((a,b)=> new Date(b.updated_at) - new Date(a.updated_at))[0] || collaborations[0] || null;
  }

  currentGrid.innerHTML = current ? cardHTML(current) : `<div class="empty" style="grid-column:1/-1">No current project found.</div>`;

  // Remove current from the other lists
  const currentId = current ? current.id : -1;
  const collabList = collaborations.filter(r => r.id !== currentId);
  const personalList = personal.filter(r => r.id !== currentId);

  collabGrid.innerHTML   = collabList.map(cardHTML).join('');
  personalGrid.innerHTML = personalList.map(cardHTML).join('');

  document.getElementById('collab-empty').hidden   = collabList.length !== 0;
  document.getElementById('personal-empty').hidden = personalList.length !== 0;
}

(async function init(){
  try {
    const all = await fetchAll();
    window.__REPOS__ = all;
    renderLangOptions(all);
    renderSections(all);
  } catch(err){
    const g = document.getElementById('personal-grid');
    if (g) g.outerHTML = `<div class="empty">${err.message}. You might be rate-limited. Try again later.</div>`;
  }

  document.getElementById('q').addEventListener('input', ()=>renderSections(window.__REPOS__ || []));
  document.getElementById('lang').addEventListener('change', ()=>renderSections(window.__REPOS__ || []));
  document.getElementById('sort').addEventListener('change', ()=>renderSections(window.__REPOS__ || []));
  document.getElementById('reset').addEventListener('click', ()=>{
    document.getElementById('q').value='';
    document.getElementById('lang').value='';
    document.getElementById('sort').value='updated';
    renderSections(window.__REPOS__ || []);
  });
})();
</script>
</body>
</html>
